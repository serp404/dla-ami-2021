# TTS homework

## Installation guide

Запустить `init.sh`. Он должен установить требуемую версию `pytorch`, скачать и распаковать `LJSpeech` в нужную директорию, запустить установку всех пакетов из `requirements.txt` и скачать финальную версию весов генератора (версия V1):

```shell
sh init.sh
```

## Training

Весь пайплайн обучения реализован в файле `train.py`, который может принимать параметры `resume_gen`, `resume_dis` и `device` через аргументы командной строки (через `resume_gen` передается путь к весам генератора, которую хотим дообучить, через `resume_dis`веса дискриминаторов, через`device` принудительно передаем девайс). Пример запуска:

```shell
python train.py --device cuda
```

Параметры обучения и модели можно передать через `hw_nv/config.py` (интерфейс должен быть интуитивно понятен). В качесте шедулера поддерживаются также шедулеры из `transformers.optimization`, но это скорее осталось от прошлой домашки (в этой трансформеров не наблюдается). Если вдруг кому-то очень захочется поменять параметры спектрограмм, то это тоже можно сделать, поправив `MelSpectrogramConfig` в `hw_nv/melspecs`.

## Testing

Пайплайн тестирования реализован в файле `test.py`, который может принимать четыре аргументы командной строки: `modelpath` (путь к весам тестируемого генератора), `testpath` (путь к директории с тестовыми аудио), `outputdir` (путь к папке, куда будут сохранены предсказанные аудио) и `device` (в целом можно догадаться, что это или посмотреть часть про `training`). Пример запуска:

```shell
python test.py --modelpath ./data/gen.pth --testpath ./test_data/ --outputdir ./test_results --device cuda
```

Если переданной папки для результата не существует, то она будет создана. Также сразу в директории лежит папка с тестовыми аудио `test_data` и директория с предсказанными финальной моделью по ним аудио `test_results`.

## Materials

Отчет о работе, веса моделей, а также предсказанные тестовые аудио можно найти на гугл-диске:

<https://drive.google.com/drive/folders/1QlcC0nhhLVkDLrDRpsWVxdwPIZTsTZBq?usp=sharing>

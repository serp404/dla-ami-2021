# TTS homework

## Installation guide

Запустить `init.sh`. Он должен установить требуемую версию `pytorch`, скачать и распаковать `LJSpeech` в нужную директорию, склонировать `waveglow`, запустить установку всех пакетов из `requirements.txt` и скачать финальную версию весов модели:

```shell
sh init.sh
```

## Training

Весь пайплайн обучения реализован в файле `train.py`, который может принимать параметры `resume` и `device` через аргументы командной строки (через `resume` передается путь к весам моедли, которую хотим дообучить, через `device` принудительно передаем девайс). Пример запуска:

```shell
python train.py --device cuda
```

Параметры обучения и модели можно передать через `hw_tts/config.py` (интерфейс должен быть интуитивно понятен). В качесте шедулера поддерживаются также шедулеры из `transformers.optimization`. Если вдруг кому-то очень захочется поменять параметры спектрограмм, то это тоже можно сделать, поправив `MelSpectrogramConfig` в `hw_tts/melspecs`.

## Testing

Пайплайн тестирования реализован в файле `test.py`, который может принимать четыре аргументы командной строки: `modelpath` (путь к весам тестируемой модели), `testpath` (путь к файл с тестовыми предложениями), `outputdir` (путь к папке, куда будут сохранены предсказанные аудио) и `device` (в целом можно догадаться, что это или посмотреть часть про `training`). Пример запуска:

```shell
python test.py --modelpath ./data/model.pth --testpath test_sentences.txt --device cuda
```

## Materials

Отчет о работе, веса модели, а также предсказанные тестовые аудио можно найти на гугл-диске:

<https://drive.google.com/drive/folders/1uxgskU4OUPN-74LBD5bw4YXSYsNATYBU?usp=sharing>
